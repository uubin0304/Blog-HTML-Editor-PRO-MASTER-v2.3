<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ë¸”ë¡œê·¸ HTML ì—ë””í„° PRO MASTER v3.1</title>
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/monokai.min.css" />
  <style>
    :root {
      --primary: #6366f1;
      --bg-dark: #0f172a;
      --bg-darker: #020617;
      --bg-light: #1e293b;
      --text-primary: #f1f5f9;
      --border: #334155;
    }
    body.dark-mode { --bg-dark: #000; --bg-darker: #111; --bg-light: #222; --border: #444; }
    body { font-family: 'Inter', system-ui, sans-serif; background: linear-gradient(135deg, var(--bg-dark), var(--bg-darker)); color: var(--text-primary); height: 100vh; margin: 0; display: flex; flex-direction: column; overflow: hidden; }

    /* í—¤ë” & íˆ´ë°” */
    .header { background: rgba(15, 23, 42, 0.95); border-bottom: 2px solid var(--primary); padding: 0.6rem 1rem; z-index: 100; }
    .header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; }
    .header h1 { font-size: 1.1rem; margin: 0; background: linear-gradient(135deg, #818cf8, #c084fc); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    
    .toolbar { display: flex; flex-wrap: wrap; gap: 5px; align-items: center; }
    .separator { width: 1px; background: var(--border); margin: 0 5px; height: 24px; }
    
    .btn { padding: 6px 12px; border: none; border-radius: 6px; font-size: 0.8rem; font-weight: 700; cursor: pointer; display: inline-flex; align-items: center; gap: 5px; transition: 0.2s; }
    .btn:hover { transform: translateY(-1px); filter: brightness(1.1); }
    .btn-primary { background: var(--primary); color: white; }
    .btn-secondary { background: var(--bg-light); color: var(--text-primary); border: 1px solid var(--border); }
    .btn-success { background: #10b981; color: white; }
    .btn-danger { background: #ef4444; color: white; }

    /* ì‘ì—… ê³µê°„ */
    .workspace { flex: 1; display: flex; overflow: hidden; }
    .pane { width: 50%; display: flex; flex-direction: column; border-right: 1px solid var(--border); }
    .pane-header { background: var(--bg-darker); padding: 5px 10px; font-size: 0.7rem; font-weight: bold; color: #888; display: flex; justify-content: space-between; align-items: center; }
    
    /* ì—ë””í„° */
    .CodeMirror { flex: 1; height: auto !important; font-size: 14px; font-family: 'Consolas', monospace; }
    
    /* ë¯¸ë¦¬ë³´ê¸° (ë‹¤í¬ëª¨ë“œì—¬ë„ í•­ìƒ í°ìƒ‰ ìœ ì§€) */
    #preview-pane { background: #e2e8f0 !important; }
    .preview-content { flex: 1; overflow: auto; padding: 20px; display: flex; justify-content: center; }
    .preview-viewport { 
      background: white !important; 
      width: 100%; max-width: 800px; min-height: 100%; 
      box-shadow: 0 10px 40px rgba(0,0,0,0.15); border-radius: 8px; 
      transition: width 0.3s;
    }
    iframe { width: 100%; height: 100%; border: none; display: block; }

    /* SEO ìƒíƒœë°” */
    .seo-bar { background: var(--bg-darker); padding: 8px 15px; font-size: 0.8rem; border-top: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
    .seo-stat { margin-right: 15px; font-weight: bold; }
    .seo-good { color: #10b981; } .seo-bad { color: #ef4444; }

    /* ëª¨ë‹¬ ê³µí†µ */
    .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 2000; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
    .modal.active { display: flex; }
    .modal-card { background: var(--bg-dark); border: 1px solid var(--border); padding: 25px; border-radius: 15px; width: 90%; max-width: 600px; max-height: 85vh; overflow-y: auto; color: var(--text-primary); box-shadow: 0 25px 50px rgba(0,0,0,0.5); }
    .modal h2 { margin-top: 0; color: var(--primary); }
    .field { margin-bottom: 15px; }
    .field label { display: block; margin-bottom: 5px; font-size: 0.8rem; color: #999; }
    .field input, .field select, .field textarea { width: 100%; padding: 8px; background: var(--bg-darker); border: 1px solid var(--border); color: white; border-radius: 6px; box-sizing: border-box; }
    .theme-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px; }
    .theme-card { background: var(--bg-darker); border: 1px solid var(--border); padding: 10px; border-radius: 8px; cursor: pointer; text-align: center; }
    .theme-card:hover, .theme-card.active { border-color: var(--primary); background: var(--bg-light); }
    .color-dot { width: 100%; height: 10px; border-radius: 5px; margin-bottom: 5px; }

    .help-step { background: rgba(255,255,255,0.05); padding: 12px; border-radius: 8px; margin-bottom: 8px; border-left: 4px solid var(--primary); }
  </style>
</head>
<body class="light-mode">
  <header class="header">
    <div class="header-top">
      <h1>ğŸ¨ BLOG EDITOR <span style="font-size:0.7em; opacity:0.7;">PRO v3.1</span></h1>
      <div style="display:flex; gap:8px;">
        <button class="btn btn-secondary" onclick="toggleDarkMode()">ğŸŒ“ ëª¨ë“œì „í™˜</button>
        <button class="btn btn-secondary" style="background:#4f46e5; border:none; color:white;" onclick="openModal('help')">â“ ë„ì›€ë§</button>
        <button class="btn btn-primary" onclick="copyHTML()">ğŸ“‹ ì „ì²´ë³µì‚¬</button>
        <button class="btn btn-danger" onclick="resetEditor()">ğŸ”„ ë¦¬ì…‹</button>
      </div>
    </div>
    <div class="toolbar">
      <button class="btn btn-secondary" title="ì‹¤í–‰ì·¨ì†Œ (Ctrl+Z)" onclick="editor.undo()">âŸ²</button>
      <button class="btn btn-secondary" title="ë‹¤ì‹œì‹¤í–‰ (Ctrl+Y)" onclick="editor.redo()">âŸ³</button>
      <div class="separator"></div>
      
      <button class="btn btn-secondary" onclick="openModal('themes')">ğŸŒˆ í…Œë§ˆì„ íƒ</button>
      <button class="btn btn-success" onclick="applyThemeInline()">ğŸ¨ ì½”ë“œì— ì ìš©</button>
      <div class="separator"></div>
      <button class="btn btn-secondary" onclick="openModal('cta')">âœ¨ ë²„íŠ¼</button>
      <button class="btn btn-secondary" onclick="openModal('img')">ğŸ–¼ï¸ ì´ë¯¸ì§€</button>
      <button class="btn btn-secondary" onclick="openModal('toc')">ğŸ“‘ ëª©ì°¨</button>
      <button class="btn btn-secondary" onclick="openModal('seo')">ğŸ” SEOì„¤ì •</button>
      <button class="btn btn-secondary" onclick="openModal('app')">ğŸ“± ì•±ë¸”ë¡</button>
      <div class="separator"></div>
      <button class="btn btn-secondary" onclick="cleanHTML()">ğŸ§¹ ì½”ë“œì²­ì†Œ</button>
      <button class="btn btn-secondary" onclick="openModal('converter')">ğŸ”„ MDë³€í™˜</button>
      <button class="btn btn-secondary" onclick="insertFairTrade()">âš–ï¸ ê³µì •ìœ„</button>
    </div>
  </header>

  <main class="workspace">
    <section class="pane">
      <div class="pane-header">
        <span>HTML Source</span>
        <span style="font-size:0.7rem">Ctrl+Z: ì‹¤í–‰ì·¨ì†Œ</span>
      </div>
      <textarea id="cm-textarea"></textarea>
    </section>

    <section class="pane" id="preview-pane">
      <div class="pane-header">
        <span>Realtime Preview</span>
        <div>
          <button class="btn" style="padding:2px 6px; font-size:10px;" onclick="setVWidth('100%')">PC</button>
          <button class="btn" style="padding:2px 6px; font-size:10px;" onclick="setVWidth('375px')">Mobile</button>
        </div>
      </div>
      <div class="preview-content">
        <div class="preview-viewport" id="viewport">
          <iframe id="preview-frame"></iframe>
        </div>
      </div>
    </section>
  </main>

  <footer class="seo-bar">
    <div>
      <span class="seo-stat" id="stat-len">ê¸€ììˆ˜: 0ì</span>
      <span class="seo-stat" id="stat-h2">H2: 0ê°œ</span>
      <span class="seo-stat" id="stat-alt">ì´ë¯¸ì§€ Alt: í™•ì¸ì¤‘</span>
    </div>
    <div style="opacity:0.7; font-size:0.7rem;">Auto-saved</div>
  </footer>

  <div class="modal" id="modal-help">
    <div class="modal-card">
      <h2>ğŸš€ 3ì´ˆ ì™„ì„± ê°€ì´ë“œ</h2>
      <div class="help-step">
        <strong>Step 1. ê¸€ì“°ê¸°</strong><br>
        ì™¼ìª½ í™”ë©´ì— ê¸€ì„ ì“°ê±°ë‚˜ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”. (H2 ì œëª©ì„ ì“°ë©´ ëª©ì°¨ê°€ ìë™ ìƒì„±ë©ë‹ˆë‹¤)
      </div>
      <div class="help-step">
        <strong>Step 2. ê¾¸ë¯¸ê¸°</strong><br>
        [ğŸŒˆ í…Œë§ˆì„ íƒ]ì—ì„œ ìƒ‰ìƒì„ ê³ ë¥´ê³ , ë°˜ë“œì‹œ <b>[ğŸ¨ ì½”ë“œì— ì ìš©]</b> ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.<br>
        * ì´ ë²„íŠ¼ì„ ëˆŒëŸ¬ì•¼ ë¸”ë¡œê·¸ì— ë¶™ì—¬ë„£ì—ˆì„ ë•Œ ë””ìì¸ì´ ìœ ì§€ë©ë‹ˆë‹¤.
      </div>
      <div class="help-step">
        <strong>Step 3. ë³µì‚¬ & ë¶™ì—¬ë„£ê¸°</strong><br>
        [ğŸ“‹ ì „ì²´ë³µì‚¬] í›„ ë¸”ë¡œê·¸ ê¸€ì“°ê¸°ì˜ 'HTML ëª¨ë“œ'ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.
      </div>
      <hr style="border-color:var(--border); margin:15px 0;">
      <p><strong>ğŸ’¡ íŒ:</strong> ì™¸ë¶€ì—ì„œ ê¸€ì„ ê¸ì–´ì™”ì„ ë• [ğŸ§¹ ì½”ë“œì²­ì†Œ]ë¥¼ ëˆ„ë¥´ë©´ ê¹¨ë—í•´ì§‘ë‹ˆë‹¤.</p>
      <button class="btn btn-primary" style="width:100%" onclick="closeModal('help')">ì•Œê² ìŠµë‹ˆë‹¤!</button>
    </div>
  </div>

  <div class="modal" id="modal-themes">
    <div class="modal-card">
      <h2>ğŸŒˆ ë””ìì¸ í…Œë§ˆ ì„ íƒ</h2>
      <div class="theme-grid" id="theme-grid"></div>
      <button class="btn btn-secondary" style="width:100%; margin-top:15px;" onclick="closeModal('themes')">ë‹«ê¸°</button>
    </div>
  </div>

  <div class="modal" id="modal-img">
    <div class="modal-card">
      <h2>ğŸ–¼ï¸ ì´ë¯¸ì§€ ì‚½ì…</h2>
      <div class="field"><label>ì´ë¯¸ì§€ ì£¼ì†Œ (URL)</label><input type="text" id="img-url" placeholder="https://..."></div>
      <div class="field"><label>ì„¤ëª… (Alt íƒœê·¸ - SEOí•„ìˆ˜)</label><input type="text" id="img-alt"></div>
      <div class="field"><label>ë§í¬ (í´ë¦­ì‹œ ì´ë™)</label><input type="text" id="img-link"></div>
      <div class="field"><label>ë„ˆë¹„ (%)</label><input type="range" id="img-width" min="20" max="100" value="100" oninput="document.getElementById('img-w-val').innerText=this.value+'%'"> <span id="img-w-val">100%</span></div>
      <div style="display:flex; gap:10px;">
        <input type="checkbox" id="wp-img-mode"> <label for="wp-img-mode">ì›Œë“œí”„ë ˆìŠ¤ í˜¸í™˜ ëª¨ë“œ</label>
      </div>
      <button class="btn btn-primary" style="width:100%; margin-top:10px;" onclick="insImg()">ì‚½ì…í•˜ê¸°</button>
      <button class="btn btn-secondary" style="width:100%; margin-top:5px;" onclick="closeModal('img')">ì·¨ì†Œ</button>
    </div>
  </div>

  <div class="modal" id="modal-cta">
    <div class="modal-card">
      <h2>âœ¨ í´ë¦­ ìœ ë„ ë²„íŠ¼</h2>
      <div class="field"><label>ë²„íŠ¼ ë¬¸êµ¬</label><input type="text" id="cta-txt" value="ìì„¸íˆ ë³´ê¸° ğŸ‘‰"></div>
      <div class="field"><label>ì´ë™í•  ì£¼ì†Œ</label><input type="text" id="cta-url" placeholder="https://..."></div>
      <div class="field"><label>ë°°ê²½ ìƒ‰ìƒ</label><input type="color" id="cta-bg" value="#6366f1" style="height:40px;"></div>
      <button class="btn btn-primary" style="width:100%; margin-top:10px;" onclick="insCTA()">ë²„íŠ¼ ë§Œë“¤ê¸°</button>
      <button class="btn btn-secondary" style="width:100%; margin-top:5px;" onclick="closeModal('cta')">ì·¨ì†Œ</button>
    </div>
  </div>

  <div class="modal" id="modal-seo">
    <div class="modal-card">
      <h2>ğŸ” ê²€ìƒ‰ì—”ì§„ ìµœì í™” (SEO)</h2>
      <p style="font-size:0.8rem; color:#aaa; margin-bottom:15px;">êµ¬ê¸€ì´ ì´ ê¸€ì„ ë” ì˜ ì´í•´í•˜ë„ë¡ êµ¬ì¡°í™” ë°ì´í„°(JSON-LD)ë¥¼ ë§Œë“­ë‹ˆë‹¤.</p>
      
      <div class="field">
        <label>ê¸€ ì œëª© (Headline)</label>
        <input type="text" id="seo-headline" placeholder="ë¸”ë¡œê·¸ í¬ìŠ¤íŒ… ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
      </div>
      
      <div class="field">
        <label>ê¸€ ìš”ì•½ (Description)</label>
        <textarea id="seo-desc" style="height:80px;" placeholder="ì´ ê¸€ì˜ í•µì‹¬ ë‚´ìš©ì„ 1~2ë¬¸ì¥ìœ¼ë¡œ ìš”ì•½í•˜ì„¸ìš”."></textarea>
      </div>

      <div class="field">
        <label>ìŠ¤í‚¤ë§ˆ íƒ€ì…</label>
        <select id="seo-type">
          <option value="Article">ì¼ë°˜ í¬ìŠ¤íŒ… (Article)</option>
          <option value="FAQPage">ì§ˆë¬¸/ë‹µë³€ í˜•ì‹ (FAQ)</option>
        </select>
      </div>

      <button class="btn btn-primary" style="width:100%" onclick="insJSONLD()">ë°ì´í„° ìƒì„± ë° ì‚½ì…</button>
      <button class="btn btn-secondary" style="width:100%; margin-top:5px;" onclick="closeModal('seo')">ë‹«ê¸°</button>
    </div>
  </div>

  <div class="modal" id="modal-app">
    <div class="modal-card">
      <h2>ğŸ“± ì•± ë‹¤ìš´ë¡œë“œ ë°•ìŠ¤</h2>
      <div class="field"><label>ì•± ì´ë¦„</label><input type="text" id="app-name"></div>
      <div class="field"><label>ì•„ì´ì½˜ URL</label><input type="text" id="app-icon"></div>
      <div class="field"><label>Google Play ë§í¬</label><input type="text" id="app-google"></div>
      <div class="field"><label>App Store ë§í¬</label><input type="text" id="app-apple"></div>
      <button class="btn btn-primary" style="width:100%" onclick="insApp()">ì‚½ì…</button>
      <button class="btn btn-secondary" style="width:100%; margin-top:5px;" onclick="closeModal('app')">ì·¨ì†Œ</button>
    </div>
  </div>

  <div class="modal" id="modal-toc">
    <div class="modal-card">
      <h2>ğŸ“‘ ìë™ ëª©ì°¨ ìƒì„±</h2>
      <p>ë³¸ë¬¸ì˜ H2, H3 íƒœê·¸ë¥¼ ì°¾ì•„ ëª©ì°¨ë¥¼ ë§Œë“­ë‹ˆë‹¤.</p>
      <button class="btn btn-primary" style="width:100%" onclick="makeTOC()">ëª©ì°¨ ì‚½ì…</button>
      <button class="btn btn-secondary" style="width:100%; margin-top:5px;" onclick="closeModal('toc')">ì·¨ì†Œ</button>
    </div>
  </div>

  <div class="modal" id="modal-converter">
    <div class="modal-card" style="max-width: 700px;">
      <h2>ğŸ”„ HTML â†” Markdown ë³€í™˜ê¸°</h2>
      
      <div class="field">
        <label>ğŸ“ ì…ë ¥ (ì—¬ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”)</label>
        <textarea id="conv-input" style="height:150px; font-family: monospace; font-size: 13px; line-height: 1.5;" placeholder="HTML ë˜ëŠ” ë§ˆí¬ë‹¤ìš´ ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
      </div>

      <div style="display:flex; gap:10px; margin-bottom: 15px;">
        <button class="btn btn-primary" style="flex:1; padding:10px;" onclick="toMD()">â¬‡ï¸ HTMLì„ ë§ˆí¬ë‹¤ìš´ìœ¼ë¡œ</button>
        <button class="btn btn-success" style="flex:1; padding:10px;" onclick="toHTML()">â¬‡ï¸ ë§ˆí¬ë‹¤ìš´ì„ HTMLë¡œ</button>
      </div>

      <div class="field">
        <label>âœ¨ ë³€í™˜ ê²°ê³¼</label>
        <textarea id="conv-output" style="height:150px; font-family: monospace; font-size: 13px; line-height: 1.5; background: #000; color: #4ade80; border-color: #333;" readonly placeholder="ë³€í™˜ëœ ê²°ê³¼ê°€ ì—¬ê¸°ì— ë‚˜íƒ€ë‚©ë‹ˆë‹¤."></textarea>
      </div>

      <button class="btn btn-secondary" style="width:100%; padding:10px;" onclick="closeModal('converter')">ë‹«ê¸°</button>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/xml/xml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/htmlmixed/htmlmixed.min.js"></script>

  <script>
    /* ================= ì‹œìŠ¤í…œ ë³€ìˆ˜ ================= */
    let editor;
    let state = { t: 0, dark: false };
    
    // í…Œë§ˆ ë°ì´í„° (20ì¢… ì¤‘ í•µì‹¬ 10ì¢…)
    const THEMES = [
      { n: 'ì—ë©”ë„ë“œ', h2: '#2ecc71', h3: '#27ae60', m: '#E8F5E9', c: '#2ecc71' },
      { n: 'ì˜¤ì…˜ë¸”ë£¨', h2: '#3498db', h3: '#2980b9', m: '#e3f2fd', c: '#3498db' },
      { n: 'ë¡œì¦ˆí•‘í¬', h2: '#e91e63', h3: '#c2185b', m: '#fce4ec', c: '#e91e63' },
      { n: 'ë°”ì´ì˜¬ë ›', h2: '#9b59b6', h3: '#8e44ad', m: '#f3e5f5', c: '#9b59b6' },
      { n: 'ì˜¤ë Œì§€', h2: '#ff9800', h3: '#f57c00', m: '#fff3e0', c: '#ff9800' },
      { n: 'ì°¨ì½œê·¸ë ˆì´', h2: '#455a64', h3: '#37474f', m: '#eceff1', c: '#455a64' },
      { n: 'ë¯¼íŠ¸', h2: '#00b894', h3: '#00cec9', m: '#e0f2f1', c: '#00b894' },
      { n: 'ë„¤ì´ë¹„', h2: '#2c3e50', h3: '#34495e', m: '#ebf5fb', c: '#2c3e50' },
      { n: 'ë ˆë“œì™€ì¸', h2: '#c0392b', h3: '#a93226', m: '#f9ebea', c: '#c0392b' },
      { n: 'ê³¨ë“œ', h2: '#f1c40f', h3: '#f39c12', m: '#fef9e7', c: '#f1c40f' }
    ];

    /* ================= ì´ˆê¸°í™” ================= */
    window.onload = function() {
      editor = CodeMirror.fromTextArea(document.getElementById('cm-textarea'), {
        mode: 'htmlmixed', theme: 'monokai', lineNumbers: true, lineWrapping: true
      });

      // ìë™ ì €ì¥ ë¶ˆëŸ¬ì˜¤ê¸°
      const saved = localStorage.getItem('blog_editor_content');
      if(saved) editor.setValue(saved);
      else editor.setValue(getDefaultContent());

      editor.on('change', () => {
        render();
        updateSEO();
        localStorage.setItem('blog_editor_content', editor.getValue());
      });

      renderThemes();
      render();
      updateSEO();
    };

    function getDefaultContent() {
      return `<div style="max-width: 800px; margin: 0 auto; line-height: 1.8; color: #333;">
  <div class="meta-desc-box">
    <div class="meta-desc-title">META DESCRIPTION</div>
    <p class="meta-desc-text">
      ì´ ì˜ì—­ì€ ê²€ìƒ‰ ê²°ê³¼ì— ë…¸ì¶œë˜ëŠ” ë©”íƒ€ë””ìŠ¤í¬ë¦½ì…˜ ì˜ˆì‹œì…ë‹ˆë‹¤. í•µì‹¬ í‚¤ì›Œë“œë¥¼ ìì—°ìŠ¤ëŸ½ê²Œ í¬í•¨í•´ 2~3ë¬¸ì¥ìœ¼ë¡œ ìš”ì•½í•´ ì£¼ì„¸ìš”.
    </p>
  </div>

  <h2>ì—ë””í„° ì‚¬ìš©ë²•</h2>
  <p>ìƒë‹¨ íˆ´ë°”ì—ì„œ ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

  <h3>ì£¼ìš” ê¸°ëŠ¥</h3>
  <ul>
    <li>ğŸŒˆ 20ê°€ì§€ í…Œë§ˆ & ì¸ë¼ì¸ ì ìš©</li>
    <li>ğŸ–¼ï¸ ì´ë¯¸ì§€ ì‚½ì… (ë§í¬ + í¬ê¸° ì¡°ì ˆ)</li>
    <li>âœ¨ ë°˜ì§ì´ëŠ” ë²„íŠ¼ ìƒì„±ê¸°</li>
    <li>ğŸ“‘ ìë™ ëª©ì°¨ ìƒì„±</li>
    <li>ğŸ“ ë©”íƒ€ë””ìŠ¤í¬ë¦½ì…˜ ë°•ìŠ¤</li>
  </ul>

  <h3>ğŸš€ v3.1 ì—…ë°ì´íŠ¸ ê¸°ëŠ¥</h3>
  <ul>
    <li>ğŸ” <b>SEO ìŠ¤í‚¤ë§ˆ</b>: JSON-LD êµ¬ì¡°í™” ë°ì´í„° ìë™ ìƒì„± (ë‚ ì§œ ì œì™¸ë¨)</li>
    <li>ğŸ§¹ <b>ì½”ë“œ í´ë¦¬ë„ˆ</b>: ì§€ì €ë¶„í•œ ì™¸ë¶€ ìŠ¤íƒ€ì¼ ì›í´ë¦­ ì‚­ì œ</li>
    <li>ğŸ“± <b>ì•± ë‹¤ìš´ë¡œë“œ ë°•ìŠ¤</b>: êµ¬ê¸€/ì• í”Œ ìŠ¤í† ì–´ ë°°ë„ˆ ìƒì„±</li>
    <li>ğŸ”„ <b>ë§ˆí¬ë‹¤ìš´ ë³€í™˜ê¸°</b>: HTML â†” MD ì–‘ë°©í–¥ ì™„ë²½ ë³€í™˜</li>
    <li>âŸ² <b>ì‹¤í–‰ ì·¨ì†Œ/ë‹¤ì‹œ ì‹¤í–‰</b>: íˆ´ë°” ë²„íŠ¼ ì¶”ê°€ë¨</li>
  </ul>

  <div style="text-align:center; margin:34px 0;">
    <a href="https://www.coupang.com" class="cta-btn" target="_blank">ğŸ›’ ë²„íŠ¼ ì˜ˆì‹œ (í´ë¦­í•´ë³´ì„¸ìš”)</a>
  </div>

  <h2>ì‹œì‘í•˜ê¸°</h2>
  <p>ì´ì œ ì´ ë‚´ìš©ì„ ì§€ìš°ê³  ììœ ë¡­ê²Œ ì‘ì„±í•´ë³´ì„¸ìš”!</p>
</div>`;
    }

    /* ================= ë Œë”ë§ & ë¯¸ë¦¬ë³´ê¸° ================= */
    function render() {
      const frame = document.getElementById('preview-frame');
      const doc = frame.contentDocument;
      const code = editor.getValue();
      const t = THEMES[state.t];

      // ë¯¸ë¦¬ë³´ê¸°ìš© CSS (ë‹¤í¬ëª¨ë“œì—¬ë„ body ë°°ê²½ì€ í°ìƒ‰ ìœ ì§€!)
      const css = `
        <style>
          body { font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif; line-height: 1.8; color: #333; margin: 0; padding: 30px; background: #fff !important; }
          img { max-width: 100%; height: auto; border-radius: 8px; }
          h2 { color: ${t.h2}; border-bottom: 2px solid ${t.h2}; padding-bottom: 10px; margin-top: 40px; font-size: 1.5rem; }
          h3 { color: ${t.h3}; border-left: 5px solid ${t.h3}; padding-left: 10px; margin-top: 30px; font-size: 1.2rem; }
          a { color: ${t.h2}; text-decoration: none; font-weight: bold; }
          .meta-box { background: ${t.m}; padding: 20px; border-radius: 10px; margin: 20px 0; border: 1px solid #ddd; }
          .meta-desc-title { font-size: 0.8rem; font-weight: bold; color: #666; margin-bottom: 5px; }
          .meta-desc-text { margin: 0; font-size: 0.95rem; color: #444; }
          table { width: 100%; border-collapse: collapse; margin: 20px 0; }
          th { background: ${t.h2}; color: white; padding: 10px; }
          td { border: 1px solid #ddd; padding: 10px; }
          .cta-btn { display: block; width: 100%; max-width: 400px; margin: 20px auto; padding: 15px; background: ${t.c}; color: white !important; text-align: center; border-radius: 50px; text-decoration: none; font-weight: bold; box-shadow: 0 4px 15px rgba(0,0,0,0.2); transition: 0.3s; }
          .cta-btn:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0,0,0,0.3); }
        </style>
      `;

      doc.open();
      doc.write(css + '<body><div id="content">' + code + '</div></body>');
      doc.close();

      // í´ë¦­ ì‹œ ì—ë””í„° ìœ„ì¹˜ ì´ë™
      doc.body.onclick = function(e) {
        if(e.target.innerText) {
          const txt = e.target.innerText.substring(0, 10);
          const cursor = editor.getSearchCursor(txt);
          if(cursor.findNext()) {
            editor.setSelection(cursor.from(), cursor.to());
            editor.focus();
          }
        }
      }
    }

    function toggleDarkMode() {
      state.dark = !state.dark;
      document.body.classList.toggle('dark-mode', state.dark);
      // í”„ë¦¬ë·°ëŠ” ë‹¤ì‹œ ë Œë”ë§í•´ë„ í°ìƒ‰ ìœ ì§€ë¨ (render í•¨ìˆ˜ ë‚´ ê³ ì •)
    }

    function setVWidth(w) {
      document.getElementById('viewport').style.width = w;
    }

    /* ================= ê¸°ëŠ¥ ë¡œì§ ================= */
    
    // í…Œë§ˆ ëª©ë¡ ìƒì„±
    function renderThemes() {
      const grid = document.getElementById('theme-grid');
      grid.innerHTML = '';
      THEMES.forEach((th, idx) => {
        const el = document.createElement('div');
        el.className = 'theme-card' + (idx === state.t ? ' active' : '');
        el.innerHTML = `<div class="color-dot" style="background:${th.h2}"></div><small>${th.n}</small>`;
        el.onclick = () => {
          state.t = idx;
          renderThemes();
          render();
        };
        grid.appendChild(el);
      });
    }

    // ğŸ¨ í…Œë§ˆë¥¼ ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ë¡œ ì ìš© (ì›Œë“œí”„ë ˆìŠ¤ìš© í•µì‹¬ ê¸°ëŠ¥)
    function applyThemeInline() {
      const t = THEMES[state.t];
      const code = editor.getValue();
      const parser = new DOMParser();
      const doc = parser.parseFromString(code, 'text/html');

      // ìŠ¤íƒ€ì¼ ì£¼ì… í—¬í¼
      const addStyle = (sel, style) => {
        doc.querySelectorAll(sel).forEach(el => {
          const old = el.getAttribute('style') || '';
          el.setAttribute('style', old + ';' + style);
        });
      };

      addStyle('h2', `color:${t.h2}; border-bottom:2px solid ${t.h2}; padding-bottom:10px; margin-top:40px;`);
      addStyle('h3', `color:${t.h3}; border-left:5px solid ${t.h3}; padding-left:10px; margin-top:30px;`);
      addStyle('table', 'width:100%; border-collapse:collapse; margin:20px 0;');
      addStyle('th', `background:${t.h2}; color:white; padding:10px; border:1px solid #ddd;`);
      addStyle('td', 'border:1px solid #ddd; padding:10px;');
      
      // ë©”íƒ€ ë°•ìŠ¤ ìŠ¤íƒ€ì¼
      addStyle('.meta-box', `background:${t.m}; padding:20px; border-radius:10px; margin:20px 0; border:1px solid #ddd;`);

      // CTA ë²„íŠ¼ ìŠ¤íƒ€ì¼ ê°•í™”
      doc.querySelectorAll('.cta-btn').forEach(btn => {
        btn.setAttribute('style', `display:block; width:100%; max-width:400px; margin:20px auto; padding:15px; background:${t.c}; color:white !important; text-align:center; border-radius:50px; text-decoration:none; font-weight:bold; box-shadow:0 4px 15px rgba(0,0,0,0.2);`);
      });

      editor.setValue(doc.body.innerHTML);
      alert('í…Œë§ˆê°€ ì½”ë“œì— ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤! ì´ì œ ë³µì‚¬í•´ì„œ ì‚¬ìš©í•˜ì„¸ìš”.');
    }

    // SEO ì—…ë°ì´íŠ¸
    function updateSEO() {
      const code = editor.getValue();
      const txtLen = code.replace(/<[^>]*>/g, '').length;
      document.getElementById('stat-len').innerText = `ê¸€ììˆ˜: ${txtLen}ì`;

      const parser = new DOMParser();
      const doc = parser.parseFromString(code, 'text/html');
      
      const h2Count = doc.querySelectorAll('h2').length;
      const h2El = document.getElementById('stat-h2');
      h2El.innerText = `H2: ${h2Count}ê°œ`;
      h2El.className = h2Count > 0 ? 'seo-stat seo-good' : 'seo-stat seo-bad';

      const imgs = doc.querySelectorAll('img');
      const missingAlt = Array.from(imgs).filter(img => !img.alt).length;
      const altEl = document.getElementById('stat-alt');
      if(imgs.length === 0) {
        altEl.innerText = 'ì´ë¯¸ì§€ ì—†ìŒ'; altEl.className = 'seo-stat';
      } else if(missingAlt > 0) {
        altEl.innerText = `Alt ëˆ„ë½ ${missingAlt}ê°œ`; altEl.className = 'seo-stat seo-bad';
      } else {
        altEl.innerText = 'Alt ì™„ë²½í•¨'; altEl.className = 'seo-stat seo-good';
      }
    }

    // âœ… JSON-LD ì‚½ì… í•¨ìˆ˜ (ë‚ ì§œ ì œê±°ë¨)
    function insJSONLD() {
      const headline = document.getElementById('seo-headline').value || 'ì œëª©';
      const desc = document.getElementById('seo-desc').value || 'ì„¤ëª…';
      const type = document.getElementById('seo-type').value;

      const schema = {
        "@context": "https://schema.org",
        "@type": type,
        "headline": headline,
        "description": desc,
        "author": {
          "@type": "Person",
          "name": "Blogger"
        }
      };

      const script = `<script type="application/ld+json">${JSON.stringify(schema, null, 2)}<\/script>`;
      insertAtCursor(script);
      closeModal('seo');
      alert('SEO êµ¬ì¡°í™” ë°ì´í„°ê°€ ì‚½ì…ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }

    // ì‚½ì… í—¬í¼
    function insertAtCursor(text) {
      editor.replaceSelection(text);
      editor.focus();
    }

    // ê³µì •ìœ„ ë¬¸êµ¬
    function insertFairTrade() {
      const html = `<p style="color:#888; font-size:12px; text-align:center; margin-top:50px;">ì´ í¬ìŠ¤íŒ…ì€ ì¿ íŒ¡ íŒŒíŠ¸ë„ˆìŠ¤ í™œë™ì˜ ì¼í™˜ìœ¼ë¡œ, ì´ì— ë”°ë¥¸ ì¼ì •ì•¡ì˜ ìˆ˜ìˆ˜ë£Œë¥¼ ì œê³µë°›ìŠµë‹ˆë‹¤.</p>`;
      insertAtCursor(html);
    }

    // ì½”ë“œ ì²­ì†Œ
    function cleanHTML() {
      if(!confirm('ì™¸ë¶€ ìŠ¤íƒ€ì¼(class, style)ì„ ëª¨ë‘ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
      let code = editor.getValue();
      code = code.replace(/ style="[^"]*"/g, "").replace(/ class="[^"]*"/g, "");
      editor.setValue(code);
      alert('ì½”ë“œê°€ ì •ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }

    // ëª¨ë‹¬ ì œì–´
    function openModal(id) { document.getElementById('modal-'+id).classList.add('active'); }
    function closeModal(id) { document.getElementById('modal-'+id).classList.remove('active'); }
    
    // ë¦¬ì…‹
    function resetEditor() {
      if(confirm('ì •ë§ ì´ˆê¸°í™” í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        editor.setValue(getDefaultContent());
      }
    }

    // ë³µì‚¬
    function copyHTML() {
      navigator.clipboard.writeText(editor.getValue())
        .then(() => alert('í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. ë¸”ë¡œê·¸ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”!'));
    }

    /* ================= ìš”ì†Œ ì‚½ì… í•¨ìˆ˜ë“¤ ================= */
    
    function insImg() {
      const url = document.getElementById('img-url').value;
      const alt = document.getElementById('img-alt').value;
      const width = document.getElementById('img-width').value;
      const link = document.getElementById('img-link').value;
      const isWP = document.getElementById('wp-img-mode').checked;

      let html = `<img src="${url}" alt="${alt}" style="width:${width}%;">`;
      
      if(link) html = `<a href="${link}" target="_blank">${html}</a>`;
      if(isWP) html = `<figure class="wp-block-image">${html}</figure>`;
      
      insertAtCursor(html);
      closeModal('img');
    }

    function insCTA() {
      const txt = document.getElementById('cta-txt').value;
      const url = document.getElementById('cta-url').value;
      const html = `<br><a href="${url}" class="cta-btn" target="_blank">${txt}</a><br>`;
      insertAtCursor(html);
      closeModal('cta');
    }

    function insApp() {
      const name = document.getElementById('app-name').value;
      const icon = document.getElementById('app-icon').value;
      const gp = document.getElementById('app-google').value;
      const ap = document.getElementById('app-apple').value;
      
      let btns = '';
      if(gp) btns += `<a href="${gp}" style="display:inline-block; padding:10px 20px; background:#eee; border-radius:5px; margin:5px; text-decoration:none; color:#333;">Google Play</a>`;
      if(ap) btns += `<a href="${ap}" style="display:inline-block; padding:10px 20px; background:#eee; border-radius:5px; margin:5px; text-decoration:none; color:#333;">App Store</a>`;

      const html = `
<div style="border:1px solid #ddd; padding:20px; border-radius:15px; text-align:center; max-width:400px; margin:30px auto; box-shadow:0 4px 10px rgba(0,0,0,0.05);">
  <img src="${icon}" style="width:80px; height:80px; border-radius:18px; margin-bottom:15px;">
  <h3 style="margin:0 0 15px 0;">${name}</h3>
  <div>${btns}</div>
</div>`;
      insertAtCursor(html);
      closeModal('app');
    }

    function makeTOC() {
      const doc = new DOMParser().parseFromString(editor.getValue(), 'text/html');
      const headers = doc.querySelectorAll('h2, h3');
      if(headers.length === 0) { alert('H2 ë˜ëŠ” H3 íƒœê·¸ê°€ ì—†ìŠµë‹ˆë‹¤.'); return; }

      let toc = `<div class="meta-box"><strong>ğŸ“‘ ëª©ì°¨</strong><ul style="list-style:none; padding-left:10px;">`;
      let i = 1;
      let newContent = editor.getValue();

      headers.forEach(h => {
        const txt = h.innerText;
        const id = 'toc-' + i;
        const indent = h.tagName === 'H3' ? '20px' : '0px';
        toc += `<li style="margin-bottom:8px; padding-left:${indent}"><a href="#${id}" style="text-decoration:none; color:#555;">${txt}</a></li>`;
        
        // ë³¸ë¬¸ì— ID ì‚½ì… (ë‹¨ìˆœ ì¹˜í™˜ ë°©ì‹)
        const tag = h.tagName.toLowerCase();
        newContent = newContent.replace(`<${tag}>${txt}</${tag}>`, `<${tag} id="${id}">${txt}</${tag}>`);
        i++;
      });
      toc += '</ul></div>';
      
      editor.setValue(toc + newContent);
      closeModal('toc');
    }

    // âœ… ì—…ê·¸ë ˆì´ë“œëœ ë§ˆí¬ë‹¤ìš´ ë³€í™˜ê¸° (HTML â†’ MD)
    function toMD() {
      let html = document.getElementById('conv-input').value;
      
      let md = html
        // 1. ì¤„ë°”ê¿ˆ ë° ê³µë°± ì •ë¦¬
        .replace(/<br\s*\/?>/gmi, '\n')
        .replace(/<\/div>/gmi, '\n')
        .replace(/<\/p>/gmi, '\n\n')
        
        // 2. ì œëª© (H1 ~ H3)
        .replace(/<h1[^>]*>(.*?)<\/h1>/gmi, '# $1\n')
        .replace(/<h2[^>]*>(.*?)<\/h2>/gmi, '## $1\n')
        .replace(/<h3[^>]*>(.*?)<\/h3>/gmi, '### $1\n')
        
        // 3. êµµê²Œ, ê¸°ìš¸ì„
        .replace(/<strong[^>]*>(.*?)<\/strong>/gmi, '**$1**')
        .replace(/<b[^>]*>(.*?)<\/b>/gmi, '**$1**')
        .replace(/<em[^>]*>(.*?)<\/em>/gmi, '*$1*')
        
        // 4. ë§í¬ ë° ì´ë¯¸ì§€
        .replace(/<a[^>]*href="(.*?)"[^>]*>(.*?)<\/a>/gmi, '[$2]($1)')
        .replace(/<img[^>]*src="(.*?)"[^>]*alt="(.*?)"[^>]*>/gmi, '![$2]($1)')
        
        // 5. ë¦¬ìŠ¤íŠ¸
        .replace(/<li[^>]*>(.*?)<\/li>/gmi, '- $1\n')
        .replace(/<ul[^>]*>/gmi, '')
        .replace(/<\/ul>/gmi, '')
        
        .trim();

      document.getElementById('conv-output').value = md;
    }

    // âœ… ì—…ê·¸ë ˆì´ë“œëœ ë§ˆí¬ë‹¤ìš´ ë³€í™˜ê¸° (MD â†’ HTML)
    function toHTML() {
      let md = document.getElementById('conv-input').value;
      
      let html = md
        // 1. ì œëª©
        .replace(/^### (.*$)/gim, '<h3>$1</h3>')
        .replace(/^## (.*$)/gim, '<h2>$1</h2>')
        .replace(/^# (.*$)/gim, '<h1>$1</h1>')
        
        // 2. êµµê²Œ, ê¸°ìš¸ì„
        .replace(/\*\*(.*?)\*\*/gim, '<strong>$1</strong>')
        .replace(/\*(.*?)\*/gim, '<em>$1</em>')
        
        // 3. ì´ë¯¸ì§€ ë° ë§í¬
        .replace(/!\[(.*?)\]\((.*?)\)/gim, '<img src="$2" alt="$1">')
        .replace(/\[(.*?)\]\((.*?)\)/gim, '<a href="$2" target="_blank">$1</a>')
        
        // 4. ë¦¬ìŠ¤íŠ¸ (ê°„ë‹¨ ë³€í™˜)
        .replace(/^- (.*$)/gim, '<li>$1</li>')
        
        // 5. ì¤„ë°”ê¿ˆ
        .replace(/\n/gim, '<br>');

      document.getElementById('conv-output').value = html;
    }
  </script>
</body>
</html>
